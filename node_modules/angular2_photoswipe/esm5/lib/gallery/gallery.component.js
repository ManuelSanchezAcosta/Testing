/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ContentChildren, QueryList, ViewChild, ElementRef, EventEmitter, Input, Output } from '@angular/core';
import * as PhotoSwipe from 'photoswipe';
import * as PhotoSwipeUI_Default from 'photoswipe/dist/photoswipe-ui-default';
import { GalleryItemComponent } from '../gallery-item/gallery-item.component';
import { NgpService } from '../ngp.service';
import { LightboxAdapter } from '../lightbox-adapter';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../ngp.service';
import * as ɵngcc2 from '../lightbox-adapter';
import * as ɵngcc3 from '@angular/common';

var _c0 = ["ngpGallery"];
var _c1 = [[["ngp-gallery-item"]]];
var _c2 = function (a0) { return { "card-columns": a0 }; };
var _c3 = ["ngp-gallery-item"];
var GalleryComponent = /** @class */ (function () {
    function GalleryComponent(ngp, adapter) {
        this.ngp = ngp;
        this.adapter = adapter;
        this.shareLinkClick = new EventEmitter();
        this.subscriptions = [];
        this.images = [];
        this.isBootstrapEnabled = this.adapter.enableBootstrap4;
    }
    /**
     * @return {?}
     */
    GalleryComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        var _this_1 = this;
        this.images = (/** @type {?} */ (this.galleryItems.toArray().map((/**
         * @param {?} cp
         * @return {?}
         */
        function (cp) {
            // listen for clicks;
            _this_1.subscriptions.push(cp.clicked.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) { return _this_1.onClick(data); })));
            return cp.image;
        }))));
    };
    /**
     * @return {?}
     */
    GalleryComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.subscriptions.forEach((/**
         * @param {?} sub
         * @return {?}
         */
        function (sub) { return sub.unsubscribe(); }));
    };
    /**
     * @param {?} data
     * @return {?}
     */
    GalleryComponent.prototype.onClick = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.openPhotoSwipe(data, this.galleryElement);
    };
    /**
     * @private
     * @param {?} img
     * @param {?} galleryDOM
     * @return {?}
     */
    GalleryComponent.prototype.openPhotoSwipe = /**
     * @private
     * @param {?} img
     * @param {?} galleryDOM
     * @return {?}
     */
    function (img, galleryDOM) {
        this.adapter.galleryUID = galleryDOM.nativeElement.getAttribute('data-pswp-uid');
        this.adapter.index = img.id;
        /** @type {?} */
        var PSWP = (/** @type {?} */ (this.ngp.LightboxElement.nativeElement));
        this.pswp = new PhotoSwipe(PSWP, PhotoSwipeUI_Default, this.getImagesAsPhotoswipe(), this.adapter);
        /** @type {?} */
        var _this = this;
        this.pswp.listen('shareLinkClick', (/**
         * @param {?} e
         * @param {?} target
         * @return {?}
         */
        function (e, target) {
            _this.shareLinkClick.emit({ e: e, target: target });
        }));
        this.pswp.init();
        return false;
    };
    /**
     * @private
     * @return {?}
     */
    GalleryComponent.prototype.getImagesAsPhotoswipe = /**
     * @private
     * @return {?}
     */
    function () {
        return this.images.map((/**
         * @param {?} image
         * @return {?}
         */
        function (image) {
            return {
                src: image.largeUrl,
                w: image.width,
                h: image.height,
                pid: image.id,
                title: image.description,
                author: image.author
            };
        }));
    };
    /** @nocollapse */
    GalleryComponent.ctorParameters = function () { return [
        { type: NgpService },
        { type: LightboxAdapter }
    ]; };
    GalleryComponent.propDecorators = {
        galleryElement: [{ type: ViewChild, args: ['ngpGallery', { static: true },] }],
        galleryItems: [{ type: ContentChildren, args: [GalleryItemComponent,] }],
        galleryId: [{ type: Input }],
        shareLinkClick: [{ type: Output }]
    };
GalleryComponent.ɵfac = function GalleryComponent_Factory(t) { return new (t || GalleryComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.NgpService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LightboxAdapter)); };
GalleryComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: GalleryComponent, selectors: [["ngp-gallery"]], contentQueries: function GalleryComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, GalleryItemComponent, 0);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.galleryItems = _t);
    } }, viewQuery: function GalleryComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, 3);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.galleryElement = _t.first);
    } }, inputs: { galleryId: "galleryId" }, outputs: { shareLinkClick: "shareLinkClick" }, ngContentSelectors: _c3, decls: 3, vars: 3, consts: [["id", "sampleId", "itemscope", "", "itemtype", "http://schema.org/ImageGallery", 1, "angular2_photoswipe", 3, "ngClass"], ["ngpGallery", ""]], template: function GalleryComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef(_c1);
        ɵngcc0.ɵɵelementStart(0, "div", 0, 1);
        ɵngcc0.ɵɵprojection(2);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(1, _c2, ctx.isBootstrapEnabled));
    } }, directives: [ɵngcc3.NgClass], styles: [""] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(GalleryComponent, [{
        type: Component,
        args: [{
                selector: 'ngp-gallery',
                template: "<div class=\"angular2_photoswipe\" [ngClass]=\"{'card-columns': isBootstrapEnabled }\"  #ngpGallery id=\"sampleId\" itemscope itemtype=\"http://schema.org/ImageGallery\">\n  <ng-content select=\"ngp-gallery-item\"></ng-content>\n</div>",
                styles: [""]
            }]
    }], function () { return [{ type: ɵngcc1.NgpService }, { type: ɵngcc2.LightboxAdapter }]; }, { shareLinkClick: [{
            type: Output
        }], galleryElement: [{
            type: ViewChild,
            args: ['ngpGallery', { static: true }]
        }], galleryItems: [{
            type: ContentChildren,
            args: [GalleryItemComponent]
        }], galleryId: [{
            type: Input
        }] }); })();
    return GalleryComponent;
}());
export { GalleryComponent };
if (false) {
    /** @type {?} */
    GalleryComponent.prototype.galleryElement;
    /** @type {?} */
    GalleryComponent.prototype.galleryItems;
    /** @type {?} */
    GalleryComponent.prototype.galleryId;
    /** @type {?} */
    GalleryComponent.prototype.shareLinkClick;
    /** @type {?} */
    GalleryComponent.prototype.subscriptions;
    /** @type {?} */
    GalleryComponent.prototype.isBootstrapEnabled;
    /** @type {?} */
    GalleryComponent.prototype.pswp;
    /** @type {?} */
    GalleryComponent.prototype.images;
    /**
     * @type {?}
     * @private
     */
    GalleryComponent.prototype.ngp;
    /**
     * @type {?}
     * @private
     */
    GalleryComponent.prototype.adapter;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FsbGVyeS5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbImFuZ3VsYXIyX3Bob3Rvc3dpcGUvbGliL2dhbGxlcnkvZ2FsbGVyeS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFvQixTQUFTLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBYSxZQUFZLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN2SixPQUFPLEtBQUssVUFBVSxNQUFNLFlBQVksQ0FBQztBQUN6QyxPQUFPLEtBQUssb0JBQW9CLE1BQU0sdUNBQXVDLENBQUM7QUFFOUUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFFOUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBSTVDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQzs7Ozs7Ozs7OztBQUV0RDtBQUVZLElBZ0JWLDBCQUFvQixHQUFlLEVBQVUsT0FBd0I7QUFDdkUsUUFEc0IsUUFBRyxHQUFILEdBQUcsQ0FBWTtBQUFDLFFBQVMsWUFBTyxHQUFQLE9BQU8sQ0FBaUI7QUFBQyxRQVI1RCxtQkFBYyxHQUFvRCxJQUFJLFlBQVksRUFBRSxDQUFDO0FBQ2pHLFFBQ0Usa0JBQWEsR0FBbUIsRUFBRSxDQUFDO0FBQ3JDLFFBTUksSUFBSSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUM7QUFDckIsUUFBSSxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQztBQUM1RCxJQUFFLENBQUM7QUFDSDtBQUNPO0FBQ047QUFBUSxJQURQLDZDQUFrQjtBQUNsQjtBQUFtQjtBQUFRLElBRDNCO0FBQWMsUUFBZCxtQkFNQztBQUNILFFBTkksSUFBSSxDQUFDLE1BQU0sR0FBRyxtQkFBSyxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFB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QyxnQkFBUSxNQUFNLEVBQUUsS0FBSyxDQUFDLE1BQU07QUFDNUIsYUFBTyxDQUFDO0FBQ1IsUUFBSSxDQUFDLEVBQUMsQ0FBQztBQUNQLElBQ0UsQ0FBQyxDQTNESztBQUFDOzZCQUxSLFNBQVMsU0FBQywvQ0FLcUI7UUFKOUIsUUFBUSxFQUFFLGxCQU1TLGdCQWJaLFVBQVU7Q0FPTSxzQkFDdkIsdkJBUnFCLGdCQUlkLGVBQWU7QUFBRztBQUFVO0FBRzdCLGlDQU1MLFNBQVMsU0FBQyxZQUFZLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO0FBQU8sK0JBQy9DLGVBQWUsU0FBQyxvQkFBb0I7Z0JBTkUsaEJBTUssNEJBQzNDLEtBQUs7OEJBTFAsOUJBS1ksaUNBQ1YsTUFBTTtBQUFJOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFNO0FBQUMsSUF1RHBCLHVCQUFDO0FBQ0EsQ0FEQSxBQWpFRCxJQWlFQztBQUNELFNBN0RhLGdCQUFnQjtBQUFJO0FBQWE7QUFBcUIsSUFFakUsMENBQXNGO0FBQ3hGO0FBQXFCLElBQW5CLHdDQUFxRjtBQUN2RjtBQUFxQixJQUFuQixxQ0FBMkI7QUFDN0I7QUFBcUIsSUFBbkIsMENBQStGO0FBQ2pHO0FBQ29CLElBQWxCLHlDQUFtQztBQUNyQztBQUFxQixJQUFuQiw4Q0FBNEI7QUFDOUI7QUFFQSxJQUZFLGdDQUFpQjtBQUNuQjtBQUdBLElBRkUsa0NBQWdCO0FBQ2xCO0FBQ087QUFBaUI7QUFBZ0I7QUFBUSxJQUFsQywrQkFBdUI7QUFBQztBQUFRO0FBQWlCO0FBQzNEO0FBQVEsSUFEMkIsbUNBQWdDO0FBQUM7QUFBRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgQ29udGVudENoaWxkcmVuLCBBZnRlckNvbnRlbnRJbml0LCBRdWVyeUxpc3QsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgT25EZXN0cm95LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCAqIGFzIFBob3RvU3dpcGUgZnJvbSAncGhvdG9zd2lwZSc7XG5pbXBvcnQgKiBhcyBQaG90b1N3aXBlVUlfRGVmYXVsdCBmcm9tICdwaG90b3N3aXBlL2Rpc3QvcGhvdG9zd2lwZS11aS1kZWZhdWx0JztcblxuaW1wb3J0IHsgR2FsbGVyeUl0ZW1Db21wb25lbnQgfSBmcm9tICcuLi9nYWxsZXJ5LWl0ZW0vZ2FsbGVyeS1pdGVtLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBJbWFnZSB9IGZyb20gJy4uL2ltYWdlJztcbmltcG9ydCB7IE5ncFNlcnZpY2UgfSBmcm9tICcuLi9uZ3Auc2VydmljZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgTGlnaHRib3hPcHRpb25zIH0gZnJvbSAnLi4vbGlnaHRib3gtb3B0aW9ucyc7XG5pbXBvcnQgeyBMaWdodGJveEFkYXB0ZXIgfSBmcm9tICcuLi9saWdodGJveC1hZGFwdGVyJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmdwLWdhbGxlcnknLFxuICB0ZW1wbGF0ZVVybDogJy4vZ2FsbGVyeS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2dhbGxlcnkuY29tcG9uZW50LmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIEdhbGxlcnlDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlckNvbnRlbnRJbml0LCBPbkRlc3Ryb3kge1xuXG4gIEBWaWV3Q2hpbGQoJ25ncEdhbGxlcnknLCB7IHN0YXRpYzogdHJ1ZSB9KSBnYWxsZXJ5RWxlbWVudDogRWxlbWVudFJlZjxIVE1MRGl2RWxlbWVudD47XG4gIEBDb250ZW50Q2hpbGRyZW4oR2FsbGVyeUl0ZW1Db21wb25lbnQpIGdhbGxlcnlJdGVtczogUXVlcnlMaXN0PEdhbGxlcnlJdGVtQ29tcG9uZW50PjtcbiAgQElucHV0KCkgZ2FsbGVyeUlkOiBzdHJpbmc7XG4gIEBPdXRwdXQoKSBzaGFyZUxpbmtDbGljazogRXZlbnRFbWl0dGVyPHsgZTogRXZlbnQsIHRhcmdldDogSFRNTEVsZW1lbnQgfT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgc3Vic2NyaXB0aW9uczogU3Vic2NyaXB0aW9uW10gPSBbXTtcbiAgaXNCb290c3RyYXBFbmFibGVkOiBib29sZWFuO1xuICBwc3dwOiBQaG90b1N3aXBlO1xuXG4gIGltYWdlczogSW1hZ2VbXTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG5ncDogTmdwU2VydmljZSwgcHJpdmF0ZSBhZGFwdGVyOiBMaWdodGJveEFkYXB0ZXIpIHtcbiAgICB0aGlzLmltYWdlcyA9IFtdO1xuICAgIHRoaXMuaXNCb290c3RyYXBFbmFibGVkID0gdGhpcy5hZGFwdGVyLmVuYWJsZUJvb3RzdHJhcDQ7XG4gIH1cblxuICBuZ0FmdGVyQ29udGVudEluaXQoKSB7XG4gICAgdGhpcy5pbWFnZXMgPSA8YW55PnRoaXMuZ2FsbGVyeUl0ZW1zLnRvQXJyYXkoKS5tYXAoY3AgPT4ge1xuICAgICAgLy8gbGlzdGVuIGZvciBjbGlja3M7XG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChjcC5jbGlja2VkLnN1YnNjcmliZSgoZGF0YSkgPT4gdGhpcy5vbkNsaWNrKGRhdGEpKSk7XG4gICAgICByZXR1cm4gY3AuaW1hZ2U7XG4gICAgfSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnMuZm9yRWFjaChzdWIgPT4gc3ViLnVuc3Vic2NyaWJlKCkpO1xuICB9XG5cbiAgb25DbGljayhkYXRhKSB7XG4gICAgdGhpcy5vcGVuUGhvdG9Td2lwZShkYXRhLCB0aGlzLmdhbGxlcnlFbGVtZW50KTtcbiAgfVxuXG4gIHByaXZhdGUgb3BlblBob3RvU3dpcGUoaW1nOiBJbWFnZSwgZ2FsbGVyeURPTTogRWxlbWVudFJlZik6IGJvb2xlYW4ge1xuICAgIHRoaXMuYWRhcHRlci5nYWxsZXJ5VUlEID0gZ2FsbGVyeURPTS5uYXRpdmVFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1wc3dwLXVpZCcpO1xuICAgIHRoaXMuYWRhcHRlci5pbmRleCA9IGltZy5pZDtcbiAgICBjb25zdCBQU1dQOiBIVE1MRWxlbWVudCA9IDxIVE1MRWxlbWVudD50aGlzLm5ncC5MaWdodGJveEVsZW1lbnQubmF0aXZlRWxlbWVudDtcbiAgICB0aGlzLnBzd3AgPSBuZXcgUGhvdG9Td2lwZShQU1dQLCBQaG90b1N3aXBlVUlfRGVmYXVsdCwgdGhpcy5nZXRJbWFnZXNBc1Bob3Rvc3dpcGUoKSwgdGhpcy5hZGFwdGVyKTtcbiAgICBjb25zdCBfdGhpcyA9IHRoaXM7XG4gICAgdGhpcy5wc3dwLmxpc3Rlbignc2hhcmVMaW5rQ2xpY2snLCBmdW5jdGlvbiAoZSwgdGFyZ2V0KSB7XG4gICAgICBfdGhpcy5zaGFyZUxpbmtDbGljay5lbWl0KHsgZSwgdGFyZ2V0IH0pO1xuICAgIH0pO1xuICAgIHRoaXMucHN3cC5pbml0KCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRJbWFnZXNBc1Bob3Rvc3dpcGUoKTogYW55W10ge1xuICAgIHJldHVybiB0aGlzLmltYWdlcy5tYXAoaW1hZ2UgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3JjOiBpbWFnZS5sYXJnZVVybCxcbiAgICAgICAgdzogaW1hZ2Uud2lkdGgsXG4gICAgICAgIGg6IGltYWdlLmhlaWdodCxcbiAgICAgICAgcGlkOiBpbWFnZS5pZCxcbiAgICAgICAgdGl0bGU6IGltYWdlLmRlc2NyaXB0aW9uLFxuICAgICAgICBhdXRob3I6IGltYWdlLmF1dGhvclxuICAgICAgfTtcbiAgICB9KTtcblxuICB9XG59XG4iXX0=